---
ID: "4ed80e5e-f349-4642-bfca-d52bd30eaf56"
Parent: "a608590e-6b4d-4bd0-bebe-9753037072cc"
Template: "dd22f1b3-bd87-4db2-9e7d-f7a496888d43"
Path: "/sitecore/system/Modules/PowerShell/Script Library/SPE - Reporting/Content Reports/Reports/Solution Audit/How many of each custom template is used"
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: Core2/32x32/colour_wheel.png
- ID: "b1a94ff0-6897-47c0-9c51-aa6acb80b1f0"
  Hint: Script
  Value: |
    <#
        .SYNOPSIS
            How many custom templates are in use in your solution?
            Before executing this script point the "Context Item" to where you store your solution templates e.g. "Sitecore/templates/My Site Templates"
            
        .NOTES
            Michael West
            Adam najmanowicz
    
        .LINKS
            https://gist.github.com/AdamNaj/3b1f7c9519c3c36ecb8ccbe5401f3966
    #>
    Import-Function Render-ReportField
    
    $ignorePattern = "^(" + ("Branches/System","Common","List Manager", "Sample", "System" -join "|") + ")"
    $templates = [Sitecore.Data.Managers.TemplateManager]::GetTemplates((Get-Database "master"))
    $reportItems = @()
    foreach($template in $templates) {
        if($template -and ($template.Value.FullName -notmatch $ignorePattern) -and -not ($template.GetType().Name -match "ErrorRecord")) {
            $templateItem = Get-Item master:\ -ID $template.Value.ID
            $items =@(Get-ItemReferrer -Database "master" -ID $template.Value.ID | Where-Object { $template.Name -ne "__Standard Values"})
            $reportItem = [PSCustomObject]@{
                "Icon" = $templateItem."__Icon"
                "Name"=$template.Value.Name
                "UsageCount"=$items.Count
            }
            $reportItems += $reportItem
        }
    }
    
    $reportItems |
      Sort-Object UsageCount -Descending |
            Show-ListView -Property Icon,@{Name="Template Name"; Expression={$_.Name}}, @{Name="Number of usages"; Expression={$_.UsageCount}}`
                -Title "Custom templates report" `
                -InfoTitle "Usage Data"`
                -InfoDescription "Count of custom templates used." 
    
    Close-Window
Languages:
- Language: en
  Fields:
  - ID: "b5e02ad9-d56f-4c41-a065-a133db87bdeb"
    Hint: __Display name
    Value: "How many of each custom template is used?"
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20121203T180757
