---
ID: "f6a96176-f9e9-4746-ae48-3a6a0f242fed"
Parent: "963e1cdd-5faf-41e2-8347-3142268aec0f"
Template: "dd22f1b3-bd87-4db2-9e7d-f7a496888d43"
Path: "/sitecore/system/Modules/PowerShell/Script Library/SPE - Reporting/Content Reports/Internal/List View/Ribbon/PSObject/Remove Links"
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: Office/32x32/link_broken.png
- ID: "1c76313e-3c8c-4807-a826-135d10c39299"
  Hint: ShowRule
  Type: Rules
  Value: |
    <ruleset>
      <rule
        uid="{FF426F4D-F107-45DC-AA1E-5874B06EEC66}">
        <conditions>
          <condition
            id="{1B499603-87C9-4440-969F-D9568CE1E926}"
            uid="197DB945BB37496FB110AD9B470F37D9"
            ValidViewName="BrokenLinks" />
        </conditions>
      </rule>
    </ruleset>
- ID: "b1a94ff0-6897-47c0-9c51-aa6acb80b1f0"
  Hint: Script
  Value: |
    $remainingItems = $allData
    foreach($brokenItem in $selectedData) {
        $item = Get-Item -Path "master:" -ID $brokenItem.ID
        Write-Host "Removing broken links from $($item.ItemPath)"
        $brokenLink = $brokenItem.BrokenLink
        
        if($brokenLink) {
            $fieldItem = $item.Fields[$brokenLink.SourceFieldID]
            $field = [Sitecore.Data.Fields.FieldTypeManager]::GetField($fieldItem)
            Write-Host "- Field $($fieldItem.Name)"
    
            $item.Editing.BeginEdit() > $null
            # TODO: Log removal of broken link
            $field.RemoveLink($brokenLink)
            $item.Editing.EndEdit() > $null
            
            $remainingItems.Remove($brokenItem) > $null
        }
    }
    
    $remainingItems | Update-ListView
    
    <#
        private void LogLinkRemove(ItemLink brokenLink)
        {
          Item sourceItem = brokenLink.GetSourceItem();
          Assert.IsNotNull((object) sourceItem, "sourceItem");
          Field field = sourceItem.Fields[brokenLink.SourceFieldID];
          string message = "Removing broken link- Database: {0}, Item: {1}, Field: {2}, Target item database: {3}, Target item path: {4}".FormatWith((object) brokenLink.SourceDatabaseName, (object) sourceItem.Paths.FullPath, (object) field.Name, (object) brokenLink.TargetDatabaseName, (object) brokenLink.TargetPath);
          Log.Info(message, (object) this);
          this.Results.Controls.Add((System.Web.UI.Control) new LiteralControl("<div>{0}</div>".FormatWith((object) message)));
        }
    #>
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20180517T000225Z
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\Admin
