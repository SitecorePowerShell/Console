---
ID: "e9cdd2d4-0faa-4fe2-802d-f686749ca236"
Parent: "7b295589-1a67-4d17-9e21-acc9fbe3a705"
Template: "dd22f1b3-bd87-4db2-9e7d-f7a496888d43"
Path: "/sitecore/system/Modules/PowerShell/Script Library/SPE - Reporting/Authorable Reports/Internal/List View/Ribbon/SearchResultItem/Rebuild"
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: Office/32x32/rebuild_index.png
- ID: "b1a94ff0-6897-47c0-9c51-aa6acb80b1f0"
  Hint: Script
  Value: |
    <#
        .SYNOPSIS
            Rebuilds search index.
            
        .NOTES
            Michael West, Adam Najmanowicz 
            https://gist.github.com/michaellwest/4118c8c285fcaf927e98
    #>
    
    $indexName  = $allData | select -first 1 | %{ $_.Fields["_indexname"] }
    if($indexName){
        $index = Get-SearchIndex -Name $indexName
    }
    
    if(!$index){
        $index = Get-SearchIndex -Name "*list*" | Select-Object -first 1
    }
    
    Write-Log "Rebuilding the $($index.Name) search index."
    $time = Measure-Command {
        Write-Progress "Rebuilding the $($index.Name) search index."
        Initialize-SearchIndex -Index $index
        $job = [Sitecore.Jobs.JobManager]::GetJobs() | Where-Object { !$_.IsDone -and $_.Name -match ($index.Name) } | Select -First 1
        while(!$job.IsDone){
            Write-Progress -Activity "Rebuilding index: $($index.Name)" `
                -Status "Indexing job is $($job.Status.State). Processed $($job.Status.Processed) documents"
            Start-Sleep -Seconds 1
        }
        Write-Log "Completed rebuilding the $($index.Name) search index in $($time.TotalSeconds) seconds."        
    }
    Write-Progress -Activity "Index rebuild complete." -Status "Done"
    Start-Sleep -Seconds 1
    Write-Progress -Activity "."  -Status "."-Completed
    
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20150627T150459
